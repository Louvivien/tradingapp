
> tradingapp_api@1.0.0 start
> node server.js

[Config] Loading environment variables from: /Users/vivienrichaud/Documents/tradingapp/server/config/.env
[Config] API Key Configuration:
[Config] - Paper Trading API Key ID: Set
[Config] - Paper Trading Secret Key: Set
[Config] - Live Trading API Key ID: Set
[Config] - Live Trading Secret Key: Set
[MongoDB] Initial readyState before connect | state=0 (disconnected)
[MongoDB] Event: connecting | state=2 (connecting)
[MongoDB] Event: connected | state=1 (connected)
[MongoDB] Connected to MongoDB
[MongoDB] Post-connect | state=1 (connected)
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:21:23 GMT',
    'content-type': 'application/json',
    'content-length': '118',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744083',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'def810f7d13750e71b5c5f737b2f37a2',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:21:23 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744083',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'c654c386e5c5c73cac5b6806ec5d5f71',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API] Initializing Alpaca client with paper trading keys
[API] Using base URL: https://paper-api.alpaca.markets
[API] Using data URL: https://data.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:21:23 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744084',
    'x-request-id': '2b18458a953285d8272fb36516ae1b78',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Success] Connected to Alpaca API. Account status: ACTIVE
Server is running on port 3000
[Scheduler] Checking for portfolios due for rebalancing...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:01 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744121',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '02bd9d02609a2633952b7380dfe03e3d',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:01 GMT',
    'content-type': 'application/json',
    'content-length': '119',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744121',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '42688217fb36db14fb0db13de85d628c',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744121',
    'x-request-id': '80e50d1b475167d0deb8e227daf26198',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744122',
    'x-request-id': '8d8ab15384835e5227536c3194926d44',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Error Response] {
  status: 403,
  statusText: 'Forbidden',
  data: {
    available: '0',
    code: 40310000,
    existing_qty: '1',
    held_for_orders: '1',
    message: 'insufficient qty available for order (requested: 1, available: 0)',
    related_orders: [ 'caa6e263-5244-4f8d-87ae-b4dd526b3e78' ],
    symbol: 'AAPL'
  },
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '226',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761744122',
    'x-request-id': 'f90ef97135c02e10f23148414a8c2978',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Rebalance] Sell order failed for AAPL: Request failed with status code 403
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Error Response] {
  status: 403,
  statusText: 'Forbidden',
  data: {
    available: '0',
    code: 40310000,
    existing_qty: '2',
    held_for_orders: '2',
    message: 'insufficient qty available for order (requested: 2, available: 0)',
    related_orders: [ '6c1c3361-5c44-4066-87d2-7b304aaba246' ],
    symbol: 'SOXL'
  },
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '226',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761744122',
    'x-request-id': '866024973b861c8d27dbeca01b77b6bc',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Rebalance] Sell order failed for SOXL: Request failed with status code 403
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Error Response] {
  status: 403,
  statusText: 'Forbidden',
  data: {
    available: '0',
    code: 40310000,
    existing_qty: '3',
    held_for_orders: '3',
    message: 'insufficient qty available for order (requested: 3, available: 0)',
    related_orders: [ '1abf5808-671e-4324-a83c-8ee8bae398f8' ],
    symbol: 'TECL'
  },
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '226',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761744123',
    'x-request-id': '05049ba0028c5fdbfdf6ab88ef89b489',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Rebalance] Sell order failed for TECL: Request failed with status code 403
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '858',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761744123',
    'x-request-id': '09bb5f6dc86f2c6b8089a699697a909b',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[HTTP] Incoming POST request for /api/auth/validate
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[HTTP] Incoming GET request for /api/auth/user
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json',
    'content-length': '118',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744155',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '1aa39003465bb143bdd3e9623b3fa79d',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744155',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'e85bc40eb59c114c3ebcb0c2a86570fc',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744155',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '061c73771412273bd5cb72e2dc9b66e5',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761744156',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '17fc30b3e83c03416eeefed48054257a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744155',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '9569febb80cbf8493e5ce3f184459fa1',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761744156',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '105e7a75784a31425d4e1e822498e622',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761744156',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'ee536a07526e871e24dd4c2197adc50e',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761744156',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '44d5b0ab3194591c84a675f3b8424862',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744155',
    'x-request-id': '2de8d10f2d4de0bb7ab1f146c4793e3e',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744155',
    'x-request-id': 'b2c2a7b0a4b3a05fcd5f56fce88ffabd',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761744156',
    'x-request-id': '7e1fd0ea5fd7991fbb833271c43f33c3',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761744156',
    'x-request-id': 'e2b7b092bf65ad1449edeb622988dc49',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json',
    'content-length': '119',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761744156',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '8ceab492561338afe5af44836472325d',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761744156',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '6a93ae3072850116053bafe763fee53f',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744155',
    'x-request-id': '4daa874801dedaed08083937b586526a',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761744157',
    'x-request-id': '7850776a60c96a6350c9ae199c9bfee0',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761744157',
    'x-request-id': '01882443b350cf144e216858df5b1f57',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761744157',
    'x-request-id': '129a397dfe036ff7076d309e674f796d',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761744157',
    'x-request-id': 'fccc3d98a93f8b91a4cd8be3ca34be09',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json',
    'content-length': '114',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744155',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '63a9e91e67f4fc3b6944afae5610891d',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744156',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '3bb7882d7ee4a0006d1379e7b5749bcc',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:22:35 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761744158',
    'x-request-id': '30d69a44545c14148c46bb49d02ff61a',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/9248ebd5e6d002abc3b2fdf86cc8ae5a
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:19 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744200',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'ce8edaac93f526f4dfb93a1c8550b779',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:19 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744200',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'ef2aab66be8dc38d1934602d5c34d0b9',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:19 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744200',
    'x-request-id': '07f8acc558832c61a0d3c9dbf0623ad4',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:20 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744200',
    'x-request-id': 'e66f6ca3fdf80fa29278de7cdd02a140',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:34 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744215',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '8ef5d45a3bf7070ef49adfacb3747936',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:34 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744215',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '4b5d122e207fef9e855e214012a1632e',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:34 GMT',
    'content-type': 'application/json',
    'content-length': '119',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744215',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f4ba9c4deb72d936cb3f020cbb510fe5',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:34 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744215',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '1cc87fdf3f9023f2c68d5a57b57469a9',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:34 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761744215',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '86cf079a725d383f1e67fa7bbe1fd026',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:34 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761744216',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '418a02c2587cfdb94a2cc1eac19c3c31',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:34 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761744215',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '1b49bfe393b940af29ac5a62f6871493',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:34 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761744216',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '0c030af87e81f9d729b3fa6224b14034',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:34 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744215',
    'x-request-id': '930b1ab7ee7e2a63010be805cb544932',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:34 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744215',
    'x-request-id': 'b5476ab6f0980339826150a16f232c1c',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:34 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744215',
    'x-request-id': '15e29f6bb4257d726602ec93084999b1',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:34 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761744216',
    'x-request-id': '4ba9da98582ed4466793dfc3e0e115e1',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:34 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761744215',
    'x-request-id': '9c281542f7ab0997e52f7deaabcca174',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:35 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761744216',
    'x-request-id': 'c4dae9d8349b87d375c64b726df58cef',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:35 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761744216',
    'x-request-id': 'da31ddc2a48467445172e154902b2eff',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:35 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761744217',
    'x-request-id': 'defb86f27443d24ebbcb7cca9f8060bf',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:35 GMT',
    'content-type': 'application/json',
    'content-length': '114',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744215',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '6e82b0b3f8ad2449658a6c82aa27d1fd',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:23:35 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744216',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '306a1a109b15a6a12e0545c80675afb4',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/9248ebd5e6d002abc3b2fdf86cc8ae5a
[HTTP] Incoming POST request for /api/auth/validate
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[HTTP] Incoming GET request for /api/auth/user
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:25:45 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744346',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'fe32137e5d14e7f1e4ee12a896e8a3bc',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:25:45 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744346',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '92d5165165120262c6066687e55c75ca',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:25:46 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744346',
    'x-request-id': 'ebee85172378e3e1bf0ecee7184d36f3',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:25:46 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744346',
    'x-request-id': '708d8157809a99ecfd67ebe1f0c8316c',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json',
    'content-length': '119',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744364',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'a4a03854628e5ec6e121924908a2c093',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744364',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '8c13b7eeb3f411adc03b309da34ed38f',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744364',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '165a030f97fe3fa47b8f9171ea79c56a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761744365',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'b0483625d6bd0696eea6ed8fa2595d95',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744364',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '324c6491b9490e8700f7a077b37037a3',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761744365',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '86719314bb2b85848dddc5af9ca5bda3',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761744365',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'cc4958c56fac4be68064b537e1aac521',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761744365',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '26c2b114531f1f0b2bf4b9d293e64539',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744364',
    'x-request-id': 'ac37d42c8fa9b4b6b6c7b61633a124ba',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761744365',
    'x-request-id': 'd99172b9dd213ca30c7c8fab4458c2f7',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744365',
    'x-request-id': '797eb4bb95761f527570629233e6f086',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744364',
    'x-request-id': '05930ca2a0e9446ce5f4357bdf3152d0',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761744365',
    'x-request-id': '6cd95f4b7da291c54ec7038b1e5b24ca',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761744366',
    'x-request-id': 'b1dc03ffaba0915466dda0a83d4fac78',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744365',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'fe16549131cf6da159ee2f95a523aca3',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json',
    'content-length': '114',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744365',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '592f38bf15b1236e25b2ec63fbc3bd6a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761744366',
    'x-request-id': '8ea98fd807a3183fe710be17e5e6901b',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761744366',
    'x-request-id': '3310ba6dd771250722f6a21cd2b3799e',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/9248ebd5e6d002abc3b2fdf86cc8ae5a
[HTTP] Incoming POST request for /api/auth/validate
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:33 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744394',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'aa5aaca25021244e7a0782b53e7fcc8b',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:33 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744394',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '881f379c8414aa9b5fb7c05a24ae2731',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[HTTP] Incoming GET request for /api/auth/user
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:34 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744394',
    'x-request-id': '4683fe0589b2d1c34fd09696321466a6',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:26:34 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744394',
    'x-request-id': 'c549d36ecb0820ef26d236233cae9724',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:28:01 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744481',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '57bab261505b5b553bc6f26b5d879a34',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:28:01 GMT',
    'content-type': 'application/json',
    'content-length': '119',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744481',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '62266a6ec8fcea83ddf6f5834ee3a988',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:28:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744481',
    'x-request-id': '6d1ec0168d0b308a301b12d87028fa6f',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:28:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744482',
    'x-request-id': 'b6d20d32b6c7720ad4697e85b80cdb82',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Error Response] {
  status: 403,
  statusText: 'Forbidden',
  data: {
    available: '0',
    code: 40310000,
    existing_qty: '1',
    held_for_orders: '1',
    message: 'insufficient qty available for order (requested: 1, available: 0)',
    related_orders: [ 'caa6e263-5244-4f8d-87ae-b4dd526b3e78' ],
    symbol: 'AAPL'
  },
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:28:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '226',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761744482',
    'x-request-id': 'c7529dbc26104e26b70816e00d000b43',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Rebalance] Sell order failed for AAPL: Request failed with status code 403
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Error Response] {
  status: 403,
  statusText: 'Forbidden',
  data: {
    available: '0',
    code: 40310000,
    existing_qty: '2',
    held_for_orders: '2',
    message: 'insufficient qty available for order (requested: 2, available: 0)',
    related_orders: [ '6c1c3361-5c44-4066-87d2-7b304aaba246' ],
    symbol: 'SOXL'
  },
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:28:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '226',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761744482',
    'x-request-id': '3c19ba0f5be3f2152b7404f68b15f4e3',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Rebalance] Sell order failed for SOXL: Request failed with status code 403
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Error Response] {
  status: 403,
  statusText: 'Forbidden',
  data: {
    available: '0',
    code: 40310000,
    existing_qty: '3',
    held_for_orders: '3',
    message: 'insufficient qty available for order (requested: 3, available: 0)',
    related_orders: [ '1abf5808-671e-4324-a83c-8ee8bae398f8' ],
    symbol: 'TECL'
  },
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:28:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '226',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761744483',
    'x-request-id': 'b4636bd7eb135b8de7464afb2924e15b',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Rebalance] Sell order failed for TECL: Request failed with status code 403
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:28:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '858',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761744483',
    'x-request-id': 'fe27f58863c0e3a2483f177f0255ead1',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:34:01 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744841',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'c161135a425f54979a846ad3dbbaaa5e',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:34:01 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744841',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '36ce3059b354bc454aa5d6279ba1bfab',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:34:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744841',
    'x-request-id': '80aec2d8988abbd05da189a0d4b84d40',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:34:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744842',
    'x-request-id': '532747b9868d967ff981349f72d320a6',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:34:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '863',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744842',
    'x-request-id': '1e5ab43988a9f5fc9728e70925bfceb9',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:34:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '857',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761744842',
    'x-request-id': '880392178d8f316789a8f6a48faed12f',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:34:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '862',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761744843',
    'x-request-id': '57b3c35e1611f199dd9cccc3035a47a0',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming POST request for /api/auth/validate
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/9248ebd5e6d002abc3b2fdf86cc8ae5a
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[HTTP] Incoming GET request for /api/auth/user
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:34:40 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744880',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'c8431d3621b7d519b32e8033fa42975b',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:34:40 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744880',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '2b3f485c3d681c9b87ac3b946a6caff5',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:34:40 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '503',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761744880',
    'x-request-id': '881d71049e4842000287a8f6ffcb0bb7',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:34:40 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761744881',
    'x-request-id': 'b1b093a87180d052a5dda0d6234a0233',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:40:01 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761745201',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '85db7a3cd9bfe09fcf7dfcafd87f1a73',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:40:01 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761745201',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'e5b1c6eacd6ee0a6ef237f905925cd87',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:40:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '508',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761745201',
    'x-request-id': 'f1e2ac9f3f0f3a72471a1944c483a1da',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:40:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761745202',
    'x-request-id': 'ce87c6c8fcefb514623e1c745ea07ec1',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:40:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '856',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761745202',
    'x-request-id': '8b07c60db07781fa4346656df6f5defd',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:46:00 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761745561',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '666403ee524760c9abf8469398572e57',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:46:00 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761745561',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '9bdd613a3f292a191644ac5ac047375f',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:46:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '500',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761745561',
    'x-request-id': 'ff8205716b13b844adb41e166ce8e37f',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:46:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761745561',
    'x-request-id': '3d3940bafb1984c34be986a49a2247f5',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:52:01 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761745921',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '8b783f7956a1dd11896dfdc07c953c55',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:52:01 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761745921',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'e1d73f45cb243d9ba74edc0a393ffdf2',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:52:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '508',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761745921',
    'x-request-id': 'd723631bce0deb2d4af2d10b14ecb98f',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:52:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761745922',
    'x-request-id': '4847434ddb0617dc4ed297c0b8859ed0',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:52:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '858',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761745922',
    'x-request-id': '973090dc9dcfaa070fee7dc4c034d10b',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[HTTP] Incoming POST request for /api/auth/validate
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/9248ebd5e6d002abc3b2fdf86cc8ae5a
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[HTTP] Incoming GET request for /api/auth/user
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:14 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746234',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'a99fd45b7436b5b2c7191cb009e4dc77',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:14 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746234',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '659357eb7016b35bc0ac8568ae038627',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:15 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '503',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746235',
    'x-request-id': 'c383f6bdcc95fe155604ae810ce2be5b',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:15 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761746235',
    'x-request-id': 'ae4e481986e5cc0bd3567593066c00a2',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:16 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746236',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '2a3fc420c38f62a6b524d0e1c458707a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:16 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746236',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '0877e8a42724f703b682542468ed998a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:16 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761746237',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '7ca483facdc5ba33c0c5792ca66d1b83',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:16 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761746237',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'dd0c17d8944fbb2b69ee6ea6cd0ace5a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:16 GMT',
    'content-type': 'application/json',
    'content-length': '125',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761746237',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '499bf9c31b0d00fcede76e1f8bea1aef',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:16 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761746237',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '85e1fbbd7ecda0db1e8ce058a5200bdb',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:16 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761746238',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'abb17eb4a9509c342a0c10a1eee0b8da',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:16 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761746238',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'b5d294283ceb41fd523d2e7edca5f928',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:16 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746237',
    'x-request-id': 'b14fbae2dda57962ee8b50ba2df2e8ce',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:16 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '503',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746237',
    'x-request-id': '4e5832c58b8fd0fd2519c55dab494ff6',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:16 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761746237',
    'x-request-id': 'eb90a26ef3af5198ee665336f4e113b4',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:16 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '503',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761746237',
    'x-request-id': '6e781af0cbb3a09586f81a9b95267c36',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:16 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '2',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761746238',
    'x-request-id': '0f53fcccd23091f48617fe7cf5b6bf9e',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:17 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '503',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761746238',
    'x-request-id': 'e80d35bfcd3ea270bb2ac425db08992a',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:17 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761746238',
    'x-request-id': '4678dddc3a8ceaaba1522a7434298381',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:17 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761746239',
    'x-request-id': '344ace1d07f0a44784836540258f4e7c',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:17 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746237',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '62db661972b2b07da011a8ff57414db8',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:57:17 GMT',
    'content-type': 'application/json',
    'content-length': '114',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761746237',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '8b48b2a9fb85ad5cb864a3e5cd95ecad',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:58:00 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746280',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'e5081794a3678ef821c85aa517f45eb4',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:58:00 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746281',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '7c783741149b8e5f25ab8c9714b9c0b5',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:58:00 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '510',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746281',
    'x-request-id': '27ec7c3b26784dc793d99d8ecbdc802f',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:58:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761746281',
    'x-request-id': '749154b58a4b44328e10a489584f20e8',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:58:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '861',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761746281',
    'x-request-id': 'ea95bae8c910df47bd03b41efc70bf5b',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming POST request for /api/auth/validate
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/9248ebd5e6d002abc3b2fdf86cc8ae5a
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[HTTP] Incoming GET request for /api/auth/user
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:58:55 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746335',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '76d3143574a704e9066fab2652e5a6dc',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:58:55 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746335',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'a57b59c9ce691f1160753e73c0d12284',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:58:55 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '503',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746335',
    'x-request-id': '3294dac0d55cabce1d852c3bd4ade122',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 13:58:55 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761746336',
    'x-request-id': '9e460cc226ff418c65389fdfd928db72',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:02:09 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746530',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '6b7ddfe6b94fbb1509accc22b3364be0',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:02:09 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746530',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'a748ea85ddf2f81be5f0082ed2316262',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:02:09 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '503',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746530',
    'x-request-id': '9306dd7be7bb50d3cbf1c85f5c175a43',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:02:10 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761746530',
    'x-request-id': 'e2fb4de4a511c88c565c715ac6f03bf7',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:04:01 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746641',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'b8d88d2e29bfd987bcd39372846f2e32',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:04:01 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746641',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'e4f57a5394e84ff9588da3038a95a425',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:04:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '509',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761746641',
    'x-request-id': 'ef4865c0f934c732a592f12667f96053',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:04:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761746642',
    'x-request-id': 'f87e5f15c9616d162a1009721c72cdb2',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:04:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '858',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761746642',
    'x-request-id': '4479bcf3a296c7a4d4af846c1438e54c',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:10:01 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761747001',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'deb58eb5ebaac93501cfe3f135f3defc',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:10:01 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761747001',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '977145483e4204a68abe4a8e0e613341',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:10:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '504',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761747001',
    'x-request-id': '42fadd3884f60050664b024bf8958517',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:10:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761747002',
    'x-request-id': '07f8871a06a97b678cb56c018a12e987',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:16:01 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761747361',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'e68c86b63233646124e569d801d79675',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:16:01 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761747361',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '2188d4464506bf942cd9a21ca059aa98',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:16:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '509',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761747361',
    'x-request-id': '15604cfe10bb9857b7d924f024f14c73',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:16:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761747361',
    'x-request-id': '8d19a5bacb5ff52b896959902b4a7da9',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:16:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '858',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761747362',
    'x-request-id': 'ef48c1952aa3f5f08845d00b784edbc7',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:22:01 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761747721',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'fea6d58f13ef9c995a44efb7fe51b101',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:22:01 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761747721',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'e97d12b118daf92d7230cb0411717818',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:22:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '504',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761747721',
    'x-request-id': '994e3792aba64aac6f6c498078a605a3',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:22:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761747721',
    'x-request-id': '43eb3e2d6996261de305278b86782d73',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:22:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '858',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761747722',
    'x-request-id': 'b52f217affab7d1f88b584cbf20bd988',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:28:01 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748081',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '991d74677bd9d57eb7e33812be2f741c',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:28:01 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748081',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'fae5d9094ec8793b5c7cbbc9fe468581',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:28:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '503',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748081',
    'x-request-id': 'cc46c13e563c4f95409095987696cacc',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:28:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748082',
    'x-request-id': 'a770ea12e4a0d4342100fda33aecc752',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:28:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '858',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748082',
    'x-request-id': '4bd2b493de00b5354b762df432cbb03d',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:34:01 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748441',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f12f1ea834b418e66fb68a030762c5f4',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:34:01 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748441',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '55facefed5181d11520a01982004b106',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:34:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '510',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748441',
    'x-request-id': 'cda10a014163e449cca1fd9b2edd88ef',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:34:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748442',
    'x-request-id': '0710a2d490440e9d683672535b09f741',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:09 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748629',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '7e56a957818103b1fb88253718b40703',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:09 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748630',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'e24478663edf25f2815fab141d89b5bc',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:09 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748630',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '5b1cf5871eba3562a8d5e4c9fc97e383',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:09 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748629',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '158f4b21956c717ef8c35506d2fea1fa',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:09 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748630',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '4303096706738d007c577056cfae0c99',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:09 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748630',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '92c07a58d237e9cf24d3103872a243b1',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:09 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748630',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f8a67e5b3a7563bd7a1713aa2dffe16a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:09 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748630',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '9c58f416233bcef20f06f7dad11fd2da',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:09 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '2',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748630',
    'x-request-id': '938bb0014c625954db2968260065ddf4',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:09 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '504',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748630',
    'x-request-id': 'f3f3fe5c62b1cdd2ac92f22dfec19ab6',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:09 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748630',
    'x-request-id': 'ee6bbc82d6e09ba147da79e0a45e88f6',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:09 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '504',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748631',
    'x-request-id': '1ebd7c6e86cdea7f673b006bcb98e972',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:09 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '504',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761748631',
    'x-request-id': '90b70d1a2f26da2e1a1f90b7f9bbc04a',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:09 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748630',
    'x-request-id': '35233a10a136193743a89e932529edf6',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:09 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761748631',
    'x-request-id': '90d26bfb4f0f2a68586ef29fe2091e4d',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:09 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761748632',
    'x-request-id': '875dbeb7a7f27d4bb52c44e6d88cd482',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:10 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748630',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '6622a3a1136d3a2a6dbf75cde3b1bbee',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:10 GMT',
    'content-type': 'application/json',
    'content-length': '114',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748630',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '0b3424e2b7f3c8f411578f398d528d50',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/9248ebd5e6d002abc3b2fdf86cc8ae5a
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/98d3d3f9769b8515362c606437c56409
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:27 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748647',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f672322b085d020524c1f33c33ec976e',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:27 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748648',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '44ccb040f97f5be5d6c739667440eaf8',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:27 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748648',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '36bf677e883e4d95f1a09e47f176cf28',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:27 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748648',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'c81c9e7ca1255a0786f0d4ec201eb25a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:27 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748648',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'bc68ca3743fba7a4cbb9fb783fe7c105',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:27 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748648',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '39046360b968dd1a07999ebd1b62bfe1',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:27 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748648',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'd1e07a11227d9e3b66b05bf1d71ba30f',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:27 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748648',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'b91e814cb698a73dc4ddf93b91efdde6',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:27 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '2',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748648',
    'x-request-id': '87b3e34c6f309a894b159de1b4d51c7b',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:27 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748648',
    'x-request-id': '33fd623602e78a155b41ee1cbe521b0b',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:27 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748648',
    'x-request-id': '615448f715174d14de7abf884c959b52',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:27 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '510',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748648',
    'x-request-id': '03f0a4828ac450bc747b5a00ab65cb78',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:27 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '510',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748649',
    'x-request-id': '12679926003b0186a6074a99d35351ed',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:27 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '510',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761748649',
    'x-request-id': '5f17ac0bcc46f7eb55ddea987c3a11f4',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:27 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761748649',
    'x-request-id': '1cc4c9e09bb5a97e393700672e653e1a',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:28 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761748649',
    'x-request-id': '2bb6d9aab30a20a12e88cea4a04f7024',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:28 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748648',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '9874c673a2d136635a26f697f5891102',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:28 GMT',
    'content-type': 'application/json',
    'content-length': '114',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748649',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '1b6025a05365c5e8e165dc9261c5ee23',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/98d3d3f9769b8515362c606437c56409
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:41 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748662',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'e0a6c179658453ab93feaaa9d2017dc6',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:41 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748662',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '65c16dc06a3c9e0efa6d55484cb01c5b',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:41 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748662',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '9787ac1e64a3f02c445020a059cacccc',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:41 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748662',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '1fd8253792805601f6f21a626c6836cf',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:41 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748662',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'b213937480c1588b7e1c7247ac7341df',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:41 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748662',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'ab96c90200fe09a3de3f0c39945bfbfc',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:41 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748662',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '50416755734649a8b4f9039bea6e8345',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:41 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748662',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '9094712e802e6fc917ac1ab7f30805ca',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:41 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '504',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748662',
    'x-request-id': '5781ddfdb5a712fac8aba55fc3860fed',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:41 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748662',
    'x-request-id': 'f7d7b06e813739ccb7bb4b9f1bd3bf54',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:41 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '504',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748662',
    'x-request-id': '75e3a576b75eb73d82a3986ff8531789',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:41 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '2',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748663',
    'x-request-id': '2e9ff837026aecbe5e8f786a50796390',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:41 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748662',
    'x-request-id': '88f63370aad75623fb60aa41a7e72134',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:41 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '510',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761748663',
    'x-request-id': 'ef15968ff1294c8b9509e247e3eb8061',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:41 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761748663',
    'x-request-id': 'f296bd0701746bc46ac5450c58b2d65f',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:42 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761748664',
    'x-request-id': '3583596497604f9e83d7bccb3fdd03fd',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:42 GMT',
    'content-type': 'application/json',
    'content-length': '114',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748662',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '72ffd82666744b22bea2e163f68afe9b',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:37:42 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748662',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '2161dd530c535536992775919e445744',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/9248ebd5e6d002abc3b2fdf86cc8ae5a
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:43 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748784',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '6c3b8655f9f9329ec31f25f18dd85dbb',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:43 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748784',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'db5cd405c28231262c5bf9b43097ac2d',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:43 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748784',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '2cf908d3c8012c9250d5b4c62862a5d6',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:43 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748784',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '1d97f340b12a7c3c29796395c33100e3',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:43 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748784',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '2c4bc7b50c8277bfaf93c2120cfc9a0c',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:43 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748784',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'fe64e0a0d6577fffeab1b7e8649365d7',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:43 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748785',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '6c3145c3fc28447e904cd146f7319f84',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:43 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748785',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '4de2a8f0b071609cc4d97aa72ba0e7b9',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:44 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '2',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748784',
    'x-request-id': '166f56af7e049dd0c13838fcfa64dec6',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:44 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '504',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748785',
    'x-request-id': '588bc548f1a5ed0b0456d6ab1ddd8bb4',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:44 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '504',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748784',
    'x-request-id': '0c49a5fc8a79fc5b5c22368a0760da31',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:44 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748784',
    'x-request-id': 'a5e4ef71dadf60b31422d46316b525e9',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:44 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748784',
    'x-request-id': '8fd850abba7bfa1f7226c5588168ecfc',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:44 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '504',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761748785',
    'x-request-id': '435b9e1f24fee64daeb8ef8f1b0c6c51',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:44 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761748786',
    'x-request-id': '6e228e26b9860f4be3a5684cdd0fe9f1',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:44 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761748786',
    'x-request-id': '587bf53d9830a796de7c77669e2995e7',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:44 GMT',
    'content-type': 'application/json',
    'content-length': '114',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748784',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '6a12008a4c7479250186804bd8abca9b',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:39:44 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748785',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'dd3c9bb80c14ded9b81a0f77788f2794',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:40:01 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748801',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '546c3ebf9b476a121e2cfc089cdd7ed9',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:40:01 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748801',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f0f2690b284c53cc8d8939c32b319e2c',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:40:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '504',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748801',
    'x-request-id': 'c1d20c29268580d1b500fb43b40efc8a',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:40:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748802',
    'x-request-id': '072e45ff0d367c0db77a4ddcfbb8f0c2',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:40:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '858',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748802',
    'x-request-id': '8b05fca3bc35290c2c414aa306004f71',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/9248ebd5e6d002abc3b2fdf86cc8ae5a
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:40:46 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748846',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '4dc7af5c4a805a228fcd2855bdc429ba',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:40:46 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748846',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'a92e0d3d0fcbee69f3221a9975908f31',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:40:46 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '497',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748847',
    'x-request-id': '3b08345f3a615cfda9caffbf214b71c7',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:40:46 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748847',
    'x-request-id': '8d804e1c02ba187a7b813c0002c70612',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/9248ebd5e6d002abc3b2fdf86cc8ae5a
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:40:48 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748849',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '3aaa003881f6027eb1f92cc92f6bea8c',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:40:48 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748849',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'a1fb815b72d9e83a21f31e4bb7a1edf8',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:40:48 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '508',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748849',
    'x-request-id': 'e4efd52b75c13362336cbdd65edf8e2b',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:40:48 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748849',
    'x-request-id': 'c7db1aa121c05ca0914a1ac7f6d35875',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:40:53 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748853',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'a2a9fae908a9021a5edafb7804501821',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:40:53 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748853',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'a48ec117a5697cadc9127da2874031dc',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:40:53 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '502',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748853',
    'x-request-id': 'c673a67fdf22f75818a4f7c047a313f2',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:40:53 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748853',
    'x-request-id': '9ae4b4d1ff44fe646cedbd00d10a7574',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/9248ebd5e6d002abc3b2fdf86cc8ae5a
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:41:01 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748862',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '46b7a8b6dd502cd226dedac2197bb2d4',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:41:01 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748862',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '8c157137efe578f4d1bc780227559898',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:41:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '503',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748862',
    'x-request-id': 'f623595cf6cac71f5fafa55d475f3ebb',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:41:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748862',
    'x-request-id': '34759dd7a28b9c7e32e11a3a57362056',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:41:19 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748879',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f108d6ca0439b23c6350c5065b467343',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:41:19 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748879',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'b8bd298a8fab6a359c74fe2bfa517619',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:41:19 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '501',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748880',
    'x-request-id': 'd29fdc83b8222b4cd03e8c749315dc25',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:41:19 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748880',
    'x-request-id': 'ab4953b61506b4ad094005fa3c4b050c',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/9248ebd5e6d002abc3b2fdf86cc8ae5a
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:24 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748944',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '33fc87a6489482bf4a4facc55e0ca027',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:24 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748944',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '10e6ab79a95497eb9983554547642ce1',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:24 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748945',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '7a932a0ef4755401c51f19daa683517d',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:24 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748945',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '1c07ca78f43ff212ac943f84024d9444',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:24 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748945',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '66a30276232d0a4b883dce295d802709',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:24 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748945',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'fd5bb39ab293821b9d897b21f7360d9c',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:24 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748945',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'a9e37ec3188cd8af375676d45659c1ad',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:24 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748945',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '8a9c237479fe27ef556d7d273c84c91b',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:24 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '508',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748945',
    'x-request-id': '0f8c5c9facf0a22b185c729555d44719',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:24 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '2',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748945',
    'x-request-id': '695774cdeca1ad55ad2912e176fc7a9c',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:24 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748945',
    'x-request-id': 'dc5f12135837a69c3c1590e409ca4426',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:24 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '501',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748945',
    'x-request-id': 'df2505b8238dd12ec043f1d909874f7e',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:24 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748945',
    'x-request-id': 'e9cb8354a2b542de350d11b2040070b9',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:24 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '501',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761748946',
    'x-request-id': '51aa28ad457d7def5a9ccd84cae46d48',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:24 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761748946',
    'x-request-id': 'ab1281e159a7dbe4a34a3fbd39e3a9ed',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:24 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761748947',
    'x-request-id': '1a3222b0a975be3890f74327638b126b',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:25 GMT',
    'content-type': 'application/json',
    'content-length': '126',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748945',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '690bcb31a52e5f7349d86c7d2c6f27e6',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:25 GMT',
    'content-type': 'application/json',
    'content-length': '114',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748945',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'b7912cc51c9befc07b31fadefe281655',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming POST request for /api/auth/validate
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[HTTP] Incoming GET request for /api/auth/user
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748954',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'e3beed1ed8ef2af08339b9a1307247c9',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748954',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'bd96c26eff77e477e561fc53eb0496c1',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748954',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'a23a8ab9615ac15d69f92badcdb26112',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748954',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '71bdb260e6a99c91b96dc427f9550288',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748955',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '1ec0e97a3166bb29e0625eed7757b8b8',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748955',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '37f78b03d2db0e511d7a0b3673c12088',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748955',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '96d0580698ea557e78fa6e9811e7ea67',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748955',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '567ffecc1aae09f03bcd1c6398745b2b',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '508',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748954',
    'x-request-id': '4f4d684ad61b885c98594109ac338fe0',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '2',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748954',
    'x-request-id': '3001aacacbf0e441afb0f697f624d364',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '508',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748955',
    'x-request-id': '4c8f4a86b93490f461fac46ca02cfde8',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748955',
    'x-request-id': '54ca81af8f7e636c0ca583c52c6c1d9e',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748954',
    'x-request-id': '7e6aae78ac4d4bd1ca61dc36c458cf98',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '508',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761748955',
    'x-request-id': 'cdddbafda5eab989bbd337e72f30581b',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761748956',
    'x-request-id': 'a9863e424925fd6ad5b048109a580dc4',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761748956',
    'x-request-id': '856645637f3d670483d89ac9bd0d9aba',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748954',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f50b14bcb0356e31b53331bb7aad5d4f',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json',
    'content-length': '114',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748955',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'db49286d7819e5ca5ec77269be492016',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748955',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'b89e65d4451dfa35a99793265e7c4c16',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748955',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'ded2b9b17aa7d45d09a751bdbb83721c',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '508',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761748957',
    'x-request-id': '002b0d9d365921561911e557a3399cd9',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:34 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761748956',
    'x-request-id': '307821e90a33b670b8e2dca2eafd898b',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/9248ebd5e6d002abc3b2fdf86cc8ae5a
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:38 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748959',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'ee85745c04c11f289d1a2ce3557795cd',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:38 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748959',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '33c5f95984b2ee2395417a9650a7970e',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:39 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '499',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748959',
    'x-request-id': 'b7a0d250922846e7258dc81571a73937',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:39 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748959',
    'x-request-id': '28f4664271d4745b7c6dedf919a1baf4',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:41 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748961',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '269bb2dae5086b41a7729a21f10ed896',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:41 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748961',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '7a35ef8eeab64385ef07772b07c51a88',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:41 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748962',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '656d36f367bfb3655186f99c2a03e65a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:41 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748961',
    'x-request-id': 'a84bbbf3114f40d6046d055c28fdfb10',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:41 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748962',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f702d40f5f092f03bfc600b16c55679c',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:41 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748962',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f6747143d29b5cafd30418b6b4748125',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:41 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748962',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '9267626322abe30f1f9dd75cd38b8986',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:41 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748962',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '2cb69630ff2e64f16b2b4b11afe337b7',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:41 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748962',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f372554ee13d08b3c72eea4b4f1abe11',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:41 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '2',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748962',
    'x-request-id': '98966883c9f5a6441f746179133635a3',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:41 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '500',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748963',
    'x-request-id': '1ff5330dce17ab698575e18bef0e9e7a',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:41 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '500',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748962',
    'x-request-id': 'bef2bf9239de0dc775abbd4493c59e8d',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:41 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748962',
    'x-request-id': '20543d8d32e65fd4fd83bef19c6ab2f4',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:41 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '500',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761748963',
    'x-request-id': 'fbd70bf65595201dc66dd0f3ca564834',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:41 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761748963',
    'x-request-id': '40b018ac8e1982eafbaefbce8a8592d8',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:42 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761748964',
    'x-request-id': '68943e2b42c91343a8b1553fcccf7fde',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:42 GMT',
    'content-type': 'application/json',
    'content-length': '114',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748962',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '42518d9dd236f0f0194091532ac4422f',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:42 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748962',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '3e61f6777eb832c47b400dc4efee3083',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:42 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748963',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '98c3d5c4497a6482f377931367ae531e',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:42 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748963',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '021d4dca69fde3db2da11b9c765d4c3a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:42 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '500',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761748964',
    'x-request-id': '5da60710d669c0803b2fbeb049e11a6e',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:42 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761748964',
    'x-request-id': '1a233ea764b515dff19e0add677cac2d',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/98d3d3f9769b8515362c606437c56409
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:45 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748965',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '0d88204651b7d3175a70042e7d5e9ddf',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:45 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748965',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '5a28c637c275257a2f4fd3292a7726f2',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:45 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748965',
    'x-request-id': '8fece9504b266671cb1432aa41783187',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:45 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '504',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748966',
    'x-request-id': '142614240610a8644e2d15c42bf64eca',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:47 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748968',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '0650bbb712e8076c3901620a1a5712e8',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:47 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748968',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '6363f0a195b4c0ff91e66edfffe8d65e',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:47 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748968',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '3ae848ffdddc00e96477cb183748237f',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:47 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748968',
    'x-request-id': '5d630326d6ee9f0b51cd0c887afdb95e',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748968',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '6a22e85e79afd08e195e16456d05810f',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748968',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '3b450c42ae192ee8039d1f441ccc11b0',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748969',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '0db6cbde27e07f7f6cbd33adedd1a13c',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748968',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '7748fd778e8d5044a0c6fdf4ca8b33b3',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748969',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '7ad7309d8f881c0981dd99fe65e628f5',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '508',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761748969',
    'x-request-id': '2fb4bb800bd5bece140224ed0fc1d9e9',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '2',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748968',
    'x-request-id': 'e6e0fd1766a638c5ee0c96bd930a7f91',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748968',
    'x-request-id': 'd3599ffae5b76ef75f09a5ad712fb425',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '508',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748969',
    'x-request-id': '22a7de305a2e6e36f15d5850606563e1',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '508',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761748969',
    'x-request-id': 'bf26ff1da0dcae5735085f7f0b3c1d0a',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748969',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'd090ee5de19890620369b45eab07f105',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761748969',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'ba08fdebaefa0790f099ae4827f24e69',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761748970',
    'x-request-id': 'f9b2605f6652cb0ebf3f2d4e2626fa2a',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761748970',
    'x-request-id': '234b590ab8629ca7b3c797de21b5662a',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761748970',
    'x-request-id': '1a07db1349d1b86db7c06ceb3a2c0b9b',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '508',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '191',
    'x-ratelimit-reset': '1761748971',
    'x-request-id': 'c9f11248a686dbb012ffc0e47b6d3f7a',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json',
    'content-length': '114',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761748968',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'fe3117859b62befa996993ae51968ba8',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Wed, 29 Oct 2025 14:42:48 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761748969',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'a0e8a4060a7d705e913acd4e14560af9',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
