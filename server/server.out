
> tradingapp_api@1.0.0 start
> node server.js

[Config] Loading environment variables from: /Users/vivienrichaud/Documents/tradingapp/server/config/.env
[Config] API Key Configuration:
[Config] - Paper Trading API Key ID: Set
[Config] - Paper Trading Secret Key: Set
[Config] - Live Trading API Key ID: Set
[Config] - Live Trading Secret Key: Set
[MongoDB] Initial readyState before connect | state=0 (disconnected)
[MongoDB] Event: connecting | state=2 (connecting)
[MongoDB] Event: connected | state=1 (connected)
[MongoDB] Connected to MongoDB
[MongoDB] Post-connect | state=1 (connected)
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:21 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836482',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '2e4e4a40231600c049ad37b5feff5f9a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:21 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836482',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f83a57ddd31d2b4e73b855379189e1a3',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API] Initializing Alpaca client with paper trading keys
[API] Using base URL: https://paper-api.alpaca.markets
[API] Using data URL: https://data.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:21 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836482',
    'x-request-id': '3e71d15e3398e9728bfa21ff9c617b6a',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Success] Connected to Alpaca API. Account status: ACTIVE
Server is running on port 3000
[HTTP] Incoming POST request for /api/auth/validate
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[Orders] Incoming request for user 6477cf0011fcccfa0365bc87 authenticated as 6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[HTTP] Incoming GET request for /api/auth/user
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:36 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836496',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'a468d5425fa2a827d99bcc7293245bd8',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:36 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836497',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'fa1f2826b6ba029fc37f5991d8bfbf65',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:36 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761836497',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '66259447e89711169da87f64f4f360bd',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:36 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761836497',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '3ff5b66d81198243485bf77ff1294199',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:36 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761836497',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'd1a6a7ca39616188df475f866d2e2233',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:36 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761836497',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '51eaf2472c92095718f80f9eb7f03f61',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:36 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836497',
    'x-request-id': '517a7e059622b389887075ac9dc387e2',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:36 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761836497',
    'x-request-id': '625eac6cf3f97dd878a0de28fe8badec',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:36 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '975',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836497',
    'x-request-id': 'e473349338de401b25ac7c64aadf780a',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:36 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761836498',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '87dadfebcfbc37f3c377031c2d9e45d5',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:36 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761836498',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '5a9a50e191cc432eddc9512777aeed06',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:36 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761836497',
    'x-request-id': 'b765ca9deef2ff42cb207e291fa62b60',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:36 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '975',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761836498',
    'x-request-id': '5e5fa3b9bcf86e2bc14d2265d12dc190',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:36 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761836498',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '518ba5075c9f5327bc4177d642617bcf',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:36 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761836498',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'd6729a073dd3c69965b55d3decfeb2f5',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:36 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761836498',
    'x-request-id': 'a59d0fd4b037ebdb6417ed0c08f866a2',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/UVXY/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:37 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '975',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761836498',
    'x-request-id': '110529b1e3e54e5bb6ae1dfccf312924',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:37 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '975',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761836499',
    'x-request-id': '1d77afcb49aca6f36e2fe88e0cb9e3c2',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:37 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761836499',
    'x-request-id': 'd6dadf49a16f8b9164371a85922f758b',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:37 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761836499',
    'x-request-id': '0e21bfaa840df4de24affa25dcf3f9e5',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Orders] Retrieved 167 orders for user 6477cf0011fcccfa0365bc87
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:37 GMT',
    'content-type': 'application/json',
    'content-length': '113',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836497',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '8511466c22449bd6f63a245cbcc7617f',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:37 GMT',
    'content-type': 'application/json',
    'content-length': '126',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761836497',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '0ee34d19057ff9abb8c3c2952da360e7',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:01:37 GMT',
    'content-type': 'application/json',
    'content-length': '128',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761836498',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'ec3cf04b17f2552365d6f96ea11b6cf3',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[HTTP] Incoming POST request for /api/auth/validate
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[Orders] Incoming request for user 6477cf0011fcccfa0365bc87 authenticated as 6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:06 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836587',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '3e3138b15881eb93bea3805aa33a6f10',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:06 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836587',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '12c25551829b32dcbea2ac235febc70e',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:06 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761836587',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'd963bc50ef93ac1ee04f7c431224f0c9',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:06 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761836587',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'cdeee39c97209dfc74d533bed8398c58',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[HTTP] Incoming GET request for /api/auth/user
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:06 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761836587',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f0ccfc8b4974e0ff3f5460751d450308',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:06 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761836587',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '95da99a6d44c0ad7c4344445502fb46a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:06 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761836587',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '1f6e940e8693cba69fbbd3efd165fae5',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:06 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761836588',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f4f3cb630b5d98d664514fa7362a6f0b',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:06 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836587',
    'x-request-id': '51e564ad6c58e9fd9af7c07e53cc42c8',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:06 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '978',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761836587',
    'x-request-id': 'e2481e485309a240da7c5776330aaf1d',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:06 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761836587',
    'x-request-id': '41c765a823ba13b330b4c6292308e761',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:07 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '978',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761836588',
    'x-request-id': 'cc71b5fed1a2014389d1a8600d92a202',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:06 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836587',
    'x-request-id': 'c7da8e871d3b9413174435fc714fb6ae',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:07 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761836588',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'ca2f64f5df98d97ab0642ba3398068af',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:07 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761836588',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '89c9202fa0adabc421b24c253d470b1a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:07 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '978',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761836588',
    'x-request-id': '7196c57fcd0528167e40609fd5792cd9',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:07 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '978',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761836589',
    'x-request-id': '15197c7b8a6b074a8ee57cd72c855005',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:07 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761836588',
    'x-request-id': '25ab100ab3a0a8e4481d422f4ad33417',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:07 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761836589',
    'x-request-id': '4267fe262a9ef2d3ffcdf0a6601c8fc6',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/UVXY/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:07 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761836590',
    'x-request-id': '2e633ad128937eac4d4b25e0f791e351',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Orders] Retrieved 167 orders for user 6477cf0011fcccfa0365bc87
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:07 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761836588',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '397bdbea41ae785c4ede821b2f23ab89',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:07 GMT',
    'content-type': 'application/json',
    'content-length': '113',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836588',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'bde4ed083b7fb369b2b12805077c7d5c',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:03:07 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761836588',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '980d9b1f75a4a379cd07060c466eaad8',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[HTTP] Incoming POST request for /api/auth/validate
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[Orders] Incoming request for user 6477cf0011fcccfa0365bc87 authenticated as 6477cf0011fcccfa0365bc87
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[HTTP] Incoming GET request for /api/auth/user
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:31 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761836852',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'e9dbbe92cadbaff50aebae64e70b0832',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:32 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761836852',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '0ca5727e33e9f19b07adad1475c28102',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:31 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836851',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'a178e8a96eb6a0c73b7cc9efebc1d809',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:31 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836852',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'e13253b11665550e826bc709cb14dfef',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:32 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836852',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '1f0fa233ba2f4989d6f824fd8a97d176',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:32 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761836852',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '7707fac192b0fd028a03af83304c5756',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:32 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761836853',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '4946e0fa26bd83e3138f255bea7702f9',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:32 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761836853',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'da71ee6827660ebd62942b601195546c',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:32 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836852',
    'x-request-id': '71d6790a9c679f047a9cd5019430c67d',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:32 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761836853',
    'x-request-id': '31c0051117ae38763e8dffbb3ee36fcc',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:33 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836853',
    'x-request-id': 'd62df07cab844e9184ba5601d1bfdaee',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:33 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761836853',
    'x-request-id': '78ca6ace84f1a442d3dc8458e189dedd',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:33 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761836853',
    'x-request-id': 'f6275ab88784b45646d5dfbcf429ebbe',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:33 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761836854',
    'x-request-id': 'f47838d52ea4da52024b5513bc74ff8d',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:33 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836853',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'e75b45f4acd7e317a3bd1065f71b5ad1',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:33 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836853',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '2cba2081a3fe8d701511d45a8b18fe7d',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:33 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761836854',
    'x-request-id': 'd88ac3e5fa4536e376d67e0525cd689c',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/UVXY/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:33 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761836854',
    'x-request-id': 'e5c02f82ab55e60b636ef165ea500011',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Orders] Retrieved 173 orders for user 6477cf0011fcccfa0365bc87
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:33 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761836855',
    'x-request-id': 'c4de20e5ba0f5802a5fd4f0b9bd88b03',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:33 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761836855',
    'x-request-id': 'c1e58177e4208a49ed4ea3597e8e1162',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:33 GMT',
    'content-type': 'application/json',
    'content-length': '126',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761836853',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '90e2f9caaf005ad6ed1ee9fb7e6b944e',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:33 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761836854',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '54b56d9e578ae6ae6d6e2deaba110e0e',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:07:33 GMT',
    'content-type': 'application/json',
    'content-length': '113',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761836854',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '49a4b0c640eefa75d77d8b3110792fef',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:12:01 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837121',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '5dfdcdc2d866f7403f8037dc60e95fb6',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:12:01 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837121',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '87f14cbed51a140f04c5cb1afe3b5756',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:12:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837122',
    'x-request-id': 'dd7f0eef100c8c132f0f043548213925',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:12:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761837123',
    'x-request-id': '7b38ee764fad7dcac415ba176a3870ff',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/UVXY/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:12:01 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837122',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '6694e7dd0c88bd9ac26eb570c1bc080c',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:12:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '859',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '190',
    'x-ratelimit-reset': '1761837125',
    'x-request-id': '6a9a440502c7cb4964193f142da36895',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:12:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '860',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '190',
    'x-ratelimit-reset': '1761837125',
    'x-request-id': 'd8e6115f0509c5ea9111c738204e11fd',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Error Response] {
  status: 422,
  statusText: 'Unprocessable Entity',
  data: { code: 42210000, message: 'asset "ARQQ" cannot be sold short' },
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:12:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '65',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '189',
    'x-ratelimit-reset': '1761837125',
    'x-request-id': '7ddb00c631da799bfd5047b227d40761',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Rebalance] Sell order failed for ARQQ: Request failed with status code 422
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Error Response] {
  status: 403,
  statusText: 'Forbidden',
  data: {
    available: '0',
    code: 40310000,
    existing_qty: '1',
    held_for_orders: '1',
    message: 'insufficient qty available for order (requested: 8, available: 0)',
    related_orders: [ '4656984b-36fd-44df-b3e0-6afeb799fce1' ],
    symbol: 'IBM'
  },
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:12:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '225',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '188',
    'x-ratelimit-reset': '1761837125',
    'x-request-id': '551dec1dda523e6649977f043b2aa126',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Rebalance] Sell order failed for IBM: Request failed with status code 403
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Error Response] {
  status: 403,
  statusText: 'Forbidden',
  data: {
    available: '0',
    code: 40310000,
    existing_qty: '4',
    held_for_orders: '4',
    message: 'insufficient qty available for order (requested: 29, available: 0)',
    related_orders: [ '3ed6185b-f1f2-43e1-b345-872f5c3fb27f' ],
    symbol: 'IONQ'
  },
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:12:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '227',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '187',
    'x-ratelimit-reset': '1761837126',
    'x-request-id': '076eed55b60d6de204cde103cd4624b4',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Rebalance] Sell order failed for IONQ: Request failed with status code 403
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Error Response] {
  status: 403,
  statusText: 'Forbidden',
  data: {
    available: '0',
    code: 40310000,
    existing_qty: '1',
    held_for_orders: '1',
    message: 'insufficient qty available for order (requested: 72, available: 0)',
    related_orders: [ '58745b57-3eac-4fdd-be0d-2542ea03d8ba' ],
    symbol: 'KO'
  },
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:12:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '225',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '187',
    'x-ratelimit-reset': '1761837126',
    'x-request-id': '1b13823ee23990661bc8079bd9120872',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Rebalance] Sell order failed for KO: Request failed with status code 403
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:12:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '859',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '186',
    'x-ratelimit-reset': '1761837126',
    'x-request-id': 'e57275ab112aabd5bb8bb8fec3015268',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:12:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '861',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '185',
    'x-ratelimit-reset': '1761837127',
    'x-request-id': 'a74b0c34de247f6c230cb5be6f05413e',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:12:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '860',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '184',
    'x-ratelimit-reset': '1761837127',
    'x-request-id': '60811bb20dcbf53e2464a53e4f5e8ba0',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:01 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837241',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '19b873994a1ca68f1cb81405cf013eb4',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:01 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837241',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'ade3ca8391efadd4b5c16f9d5bbd57aa',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837243',
    'x-request-id': 'baaf60f04380564a1120bcbeb85701a0',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761837243',
    'x-request-id': '1445f085f462ecde15b767330f5aa83c',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:02 GMT',
    'content-type': 'application/json',
    'content-length': '113',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837242',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '8ad75254ba1724e55e96c27ffa55f804',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Error Response] {
  status: 403,
  statusText: 'Forbidden',
  data: {
    available: '0',
    code: 40310000,
    existing_qty: '763',
    held_for_orders: '763',
    message: 'insufficient qty available for order (requested: 1910, available: 0)',
    related_orders: [ '11fc7533-4f94-4fa2-8dd4-357f46f25f4f' ],
    symbol: 'UVXY'
  },
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '233',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837243',
    'x-request-id': '73da6fbf5d770401344204cc3ccc07e4',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Rebalance] Sell order failed for UVXY: Request failed with status code 403
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '857',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761837244',
    'x-request-id': '98fcd6e78040e5b7a36bff05daeda4d0',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '858',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761837244',
    'x-request-id': '6cfef8b6e4db631f0829824f06ab5dfa',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Error Response] {
  status: 403,
  statusText: 'Forbidden',
  data: {
    available: '6',
    code: 40310000,
    existing_qty: '6',
    held_for_orders: '0',
    message: 'insufficient qty available for order (requested: 8, available: 6)',
    related_orders: [ '91813c84-b648-4915-add3-933a08fc73f0' ],
    symbol: 'AMD'
  },
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '225',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761837244',
    'x-request-id': '760c4ff82db17b0e73932a6da2649835',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Rebalance] Buy order failed for AMD: Request failed with status code 403
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '859',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761837244',
    'x-request-id': '0e653b5f9581b63fd16b1dcb76a6cebe',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '858',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '191',
    'x-ratelimit-reset': '1761837245',
    'x-request-id': '79d8944721db0aa585e264ff6c42165e',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '859',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '190',
    'x-ratelimit-reset': '1761837245',
    'x-request-id': '81fd151d55e0dc2567cc857b824a4da1',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[Orders] Incoming request for user 6477cf0011fcccfa0365bc87 authenticated as 6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming POST request for /api/auth/validate
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:18 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837258',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '11754740d6061e7da8ad3e79322e1217',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:18 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837259',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '6e00d3bc8af95d5a39751a8bcbffe2a3',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:18 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837259',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f2f79e9b363f871b87ab1158d18f28f5',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:18 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837259',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'daafd3594c49dc654f1c7ce8b9e2e276',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:18 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837259',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '415e9dee5e30d2cf8c6635c7126553a9',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:18 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837258',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '1e78d3f6016a40a48b1cfba956ce2322',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:18 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837259',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '5791cc57a7b44ea24718ce17cd0d6e4c',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:18 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837259',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '80f4670a6cfd30edb0e043bfbdf55b35',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:18 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837258',
    'x-request-id': '6fbc0dcd6f2f65c3f734fcc8365cc4cc',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:18 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837259',
    'x-request-id': '50d83497f63d52cbe916c6526b0c4d87',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:18 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837259',
    'x-request-id': 'b21fc76f3874c4bdb685395a26e5ee84',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/UVXY/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/KO/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/IONQ/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/ARQQ/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/AMZN/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/IBM/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:18 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837259',
    'x-request-id': '03d2d09b8cdf7b2b5f78e27b2dfd6480',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:18 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837258',
    'x-request-id': 'c4c2dff7f511c54b2acd271115139d63',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[HTTP] Incoming GET request for /api/auth/user
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:18 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837260',
    'x-request-id': '4a40efe18c3a581a2d6b30f3ef101d3d',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:19 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837260',
    'x-request-id': 'a7f515f42ee82fffa7bd02890f169608',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:19 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761837260',
    'x-request-id': '869a5653769a5f6c2c0486d8e9b7bb35',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Orders] Retrieved 197 orders for user 6477cf0011fcccfa0365bc87
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:19 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837259',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'a87f535c6a4c70fd9614df44eb1ef252',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:19 GMT',
    'content-type': 'application/json',
    'content-length': '119',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837259',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '0189bcdc9490573d742c05d25f1cc439',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:19 GMT',
    'content-type': 'application/json',
    'content-length': '128',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837260',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '182d0af62fe4abd2d7309377f643f326',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:19 GMT',
    'content-type': 'application/json',
    'content-length': '115',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837260',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '08e3fbe91e5d001f6f6daf3345edda6d',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:19 GMT',
    'content-type': 'application/json',
    'content-length': '125',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837260',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'b8469e9fb682e8d2420ba71819287085',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:19 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761837260',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '1d460902b540a3476d070fb4a5c0ce3b',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:19 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837260',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '73dbdeb52ea556580b896b7134485e31',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:19 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837260',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '3b8dfc66f159afcff9c9109fc7b94433',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:19 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761837261',
    'x-request-id': '266908b4d64ddb17a5f2eeb2f3d45ff7',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:19 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761837261',
    'x-request-id': '3c8278b745e5de3f244e92fdde213d86',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[Orders] Incoming request for user 6477cf0011fcccfa0365bc87 authenticated as 6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[HTTP] Incoming POST request for /api/auth/validate
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837270',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '75bed02dbcbd23f7ff4e4c215e6679a0',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837271',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '323ca69608f4a36a601bb345926a6adb',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837270',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'debfc6760748e745bc5216e9526a252a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837271',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'dd353b85f11bd8d56a3863c5de0180b7',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837271',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'a22408e81fb3a66d1d5d798423459aef',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837271',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '5909b0e4f4ceede3236df74ac0c056bf',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837271',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '6fb746ea850a26a6857adda56e508870',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837271',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '3af3e1004ac523d9c909bdac0a3393ae',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837271',
    'x-request-id': '85db83e7586ee0e283eae393e2ccc300',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837271',
    'x-request-id': '96b464f61658304ba63ede48b4911489',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837271',
    'x-request-id': 'afe6416e3a36819446d0ee06e8ddf08b',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/auth/user
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837271',
    'x-request-id': '7eaa939d1cae5e9ec528546691716006',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837271',
    'x-request-id': 'd78da9202d48063a3e3fb3770d196fb6',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837272',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'd3881e785d2cbc95f96c9a6084f673e0',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837272',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '9a5543432cf96162ef9a564e3cfbca60',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837272',
    'x-request-id': '337a95def4f36e6fe8aba7e2e480659e',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761837272',
    'x-request-id': '040642cbaee5e63daa5ce4e2c5acfbf8',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/UVXY/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/KO/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/IONQ/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/ARQQ/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/AMZN/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/IBM/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761837273',
    'x-request-id': '9e41db36b9bd77b8c919311135c70f3c',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:30 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761837273',
    'x-request-id': '640d45883c1b7c7cbffa7d209cf73a30',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:31 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '191',
    'x-ratelimit-reset': '1761837273',
    'x-request-id': 'f4e95c3796f8ed2c38e12ab99edcb72e',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Orders] Retrieved 197 orders for user 6477cf0011fcccfa0365bc87
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:31 GMT',
    'content-type': 'application/json',
    'content-length': '125',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837271',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '786ea4a2e9e9032b2ed7cdc400f1fcdc',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:31 GMT',
    'content-type': 'application/json',
    'content-length': '115',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837272',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'c4db8564d64a2c50f1eade65bcf5ca79',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:31 GMT',
    'content-type': 'application/json',
    'content-length': '119',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837272',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'bde0febe368938ed685c96fe950a5e36',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:31 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837272',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '1b2e9d0d06f4057d44cf19659aa9c261',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:31 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837272',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '05b4b2c0d54368e80a76f17fbd0d55f5',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:14:31 GMT',
    'content-type': 'application/json',
    'content-length': '128',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761837273',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'ad387c02b9bc5e48d30c224a2f655421',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:00 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837361',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '80e7d5ece0a5b2774d537c30e2d12a81',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:00 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837361',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '57f3d2d533b0ad24408be8ed9d5b0684',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:00 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837361',
    'x-request-id': '0b923f0377572e7e4f23c98caff591d2',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837362',
    'x-request-id': '62c86503c7256620ed806c0a05e2a615',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/KO/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:01 GMT',
    'content-type': 'application/json',
    'content-length': '125',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837361',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '9f6141161f5d0e667c1c2499b7033f08',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Error Response] {
  status: 403,
  statusText: 'Forbidden',
  data: {
    available: '0',
    code: 40310000,
    existing_qty: '4',
    held_for_orders: '4',
    message: 'insufficient qty available for order (requested: 16, available: 0)',
    symbol: 'CAT'
  },
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '168',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761837363',
    'x-request-id': '897a76460d5de279c2133ce9e7af2a31',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Rebalance] Sell order failed for CAT: Request failed with status code 403
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Error Response] {
  status: 403,
  statusText: 'Forbidden',
  data: {
    available: '0',
    code: 40310000,
    existing_qty: '656',
    held_for_orders: '656',
    message: 'insufficient qty available for order (requested: 656, available: 0)',
    symbol: 'PETS'
  },
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '174',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '191',
    'x-ratelimit-reset': '1761837364',
    'x-request-id': 'e603a1ad6c6285a1c442a9c0d5242377',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Rebalance] Sell order failed for PETS: Request failed with status code 403
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '857',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '190',
    'x-ratelimit-reset': '1761837364',
    'x-request-id': 'e20fc34e493565f8657a3368e05e5c70',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Error Response] {
  status: 403,
  statusText: 'Forbidden',
  data: {
    available: '20',
    code: 40310000,
    existing_qty: '20',
    held_for_orders: '0',
    message: 'insufficient qty available for order (requested: 31, available: 20)',
    symbol: 'PG'
  },
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '170',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '189',
    'x-ratelimit-reset': '1761837365',
    'x-request-id': '1ec387f63e8924105ff1f92cf0f87186',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Rebalance] Partial buy order failed for PG: Request failed with status code 403
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:01 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '857',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '188',
    'x-ratelimit-reset': '1761837365',
    'x-request-id': '3d1139d4b0451dc6caf1b2cbd56319ef',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'POST',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Error Response] {
  status: 403,
  statusText: 'Forbidden',
  data: {
    available: '0',
    code: 40310000,
    existing_qty: '22',
    held_for_orders: '22',
    message: 'insufficient qty available for order (requested: 22, available: 0)',
    related_orders: [ 'b2ed0c88-4a1e-47d9-9af2-848d22cb9f66' ],
    symbol: 'QBTS'
  },
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:02 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'content-length': '229',
    connection: 'keep-alive',
    'access-control-allow-origin': '*',
    vary: 'Origin',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '187',
    'x-ratelimit-reset': '1761837365',
    'x-request-id': '47909cdbb82720b3f66c9213bf7dd986',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Rebalance] Buy order failed for QBTS: Request failed with status code 403
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[Orders] Incoming request for user 6477cf0011fcccfa0365bc87 authenticated as 6477cf0011fcccfa0365bc87
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming POST request for /api/auth/validate
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[HTTP] Incoming GET request for /api/auth/user
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:30 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837391',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '20d4da54d2781da0482c4d241c800a1c',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:30 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837391',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '0be1f9a41705fac8c35d47cd6a5d9d2e',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:30 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837391',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '251cc7d3bcd6a0967d38c3caac13f1c8',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:30 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837391',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '6b006a362f8e88e1d6b1c62e2061dd46',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:30 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837391',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'aea98018badb56ccf8b73cd0a9c371fe',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:30 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837392',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'e9e7f5305a458843b04ace9b5a357d9f',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:30 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837391',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '060fb295f4a30e678e92c2f2f21de39b',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:30 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837392',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '30404ea2815a82f1eaab28d7bbb14a2a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837391',
    'x-request-id': '3b821d7e213b20867c15085c71253326',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837391',
    'x-request-id': 'eec17c8f9950523537e000f12da185bd',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837392',
    'x-request-id': 'd5272533e3e68636e4d03fb6a3396e4a',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837391',
    'x-request-id': 'aed950ccf49139d5ccddc090d628613b',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837391',
    'x-request-id': 'e254d9f1d81f683a08c5d358f114c058',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837392',
    'x-request-id': '106e3573053a5eaef5fecb4d0b3c68a5',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/UVXY/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/QBTS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/IONQ/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/ARQQ/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/AMZN/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/IBM/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837393',
    'x-request-id': 'd6479677a23a59c0bb9a4032b625cd13',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837392',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '1aa593370e27dc244590474ce1152261',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837392',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '146a219c2e4d3b5678eb72a6211ac035',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761837393',
    'x-request-id': 'c5e1824bc33dbeb524c30bf595027825',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Orders] Retrieved 200 orders for user 6477cf0011fcccfa0365bc87
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761837393',
    'x-request-id': '7cd0079ff5c89184ff4beedd8b3208af',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761837394',
    'x-request-id': 'f9be0340317164779a7f73f6e0db68ac',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837392',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '3253bf56ab49b602d2d59959ecc8e3e1',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json',
    'content-length': '126',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837392',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'fdf241d5737af547b384a24b924af77a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837392',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'cc00251eec2389815fbc0e9980047e81',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json',
    'content-length': '113',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761837393',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'e9a3cd1a098714c97b6ee74054168dff',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837393',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '3e6b9e5a0b4fd6b1612e75c8a70cb32c',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json',
    'content-length': '115',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837393',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '4afc9f5dc670353b837f6d4436de4397',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761837393',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '81870b7788af4bb0c94ac3dd37603100',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:16:31 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761837394',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'd6fdf5f77022eaa65dda5680677757eb',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming POST request for /api/auth/validate
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[Orders] Incoming request for user 6477cf0011fcccfa0365bc87 authenticated as 6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[HTTP] Incoming GET request for /api/auth/user
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:28 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837448',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'dfa0fc0d0ce27b616341e2dcd0793740',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:28 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837448',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '5bef1a20b62f6f673068b7f0fe5a2795',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:28 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837449',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'ffcba4b95e1f4cc9b64691f742d1e20d',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:28 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837449',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '047b91a5d9f27e5023722a055838e3bb',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:28 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837449',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'eadfb1435b1f99f12a022477a0dbf782',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:28 GMT',
    'content-type': 'application/json',
    'content-length': '124',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837449',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f482ffdcf7b5b73230bef331e0d171ee',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:28 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837449',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '6718d13c3f0542940932a7dc748de9cb',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:28 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837449',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '79b0ad6c24521d66e4474a72a454069e',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:28 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837449',
    'x-request-id': '38102fde68a9b890079d269c1116658e',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:28 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837449',
    'x-request-id': 'f919fc3efb60c68440c8c014978382a7',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:28 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837449',
    'x-request-id': '45afaa753c317091521ad417322bae21',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:29 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837450',
    'x-request-id': 'e72b88a25ec0e8cdd28c9050eff8ea90',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:28 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837449',
    'x-request-id': 'b60da5226ce041c08b40738cfa758800',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:29 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837450',
    'x-request-id': '3348c2c31b9ac3212c0fc5b95741b5c0',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:29 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837450',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'dbadb9bfa724acbc24c15d57d553a49a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:29 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837450',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '272a42b7b63e60307410f111d999a0ec',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:29 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837450',
    'x-request-id': '57c93e04dabfdc9642155319214d6d80',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:29 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837451',
    'x-request-id': '6077468aaea38fc09885a1e0efce5755',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Orders] Retrieved 200 orders for user 6477cf0011fcccfa0365bc87
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/UVXY/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/QBTS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/IONQ/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/ARQQ/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/AMZN/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/IBM/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:29 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761837451',
    'x-request-id': 'bb2d18accf05d38700446ca2c25038fc',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:29 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761837451',
    'x-request-id': 'ce2741bf724390ed03df71936eb35404',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:30 GMT',
    'content-type': 'application/json',
    'content-length': '128',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837451',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '3e323a37167e5bed8ed2593293731596',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:30 GMT',
    'content-type': 'application/json',
    'content-length': '113',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837450',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '2d4d073851a625a7485cb008c5072853',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:30 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837450',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'ca58a18f92cb3f4d6d2d02dc02602854',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:30 GMT',
    'content-type': 'application/json',
    'content-length': '128',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837451',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f0ce3cebbe08bfa8d8e15bb336c320e8',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:30 GMT',
    'content-type': 'application/json',
    'content-length': '119',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837452',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '55cd1a83e465dfac209877e5468f1ed3',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:30 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761837452',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '81dd4a3c93ac1ecab04f1601adfa2254',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:30 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761837452',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '64dd8bf5bba2e324a923b6bae8869e1e',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:30 GMT',
    'content-type': 'application/json',
    'content-length': '115',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761837452',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '48cba5a52f1b4ef314cbfae340936b18',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming POST request for /api/auth/validate
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[Orders] Incoming request for user 6477cf0011fcccfa0365bc87 authenticated as 6477cf0011fcccfa0365bc87
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/auth/user
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837452',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '7e76f564aba3f46ea6d0d16941d6f99b',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837452',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'ab8227234fb9f5564247cf2066ae4465',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837453',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '036233a15d7380c6c9cfb4d80794be6f',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837453',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '404d96473cc611cc76e018d66f5a3d94',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837453',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '2209f75315133c9951eb9ed636b3b9f6',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837453',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '9ad648d768ad4af3c13148f3077f52a2',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837453',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '2d7668f641756fdea83bf5dd452df0ee',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837453',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '1c69f322bbdb7feb42b59ec5358849fc',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837453',
    'x-request-id': 'fbf9fb6129cff2a7f68c8b93eb24465e',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837453',
    'x-request-id': '3eef1fb8459e4cf00c3df3bdac352d4b',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837453',
    'x-request-id': '3b95accdc8cf52410078360bcfb4ef43',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837453',
    'x-request-id': '289b778d87ba3fb68e77b41877c30d61',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837453',
    'x-request-id': '36295adaa5098b753a35e1afeab55591',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/UVXY/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/QBTS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/IONQ/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/ARQQ/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/AMZN/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/IBM/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837454',
    'x-request-id': '4fb37318b12882f5a8602b99334e04d3',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '128',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837453',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'ed23d97aea640f8820c1fb39e5e91131',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '128',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837454',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '637e91cf95e6dc8762ed23cf12f68990',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '113',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837453',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '956c937feae7373548f3e092b78046de',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '115',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761837454',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'b2e1e272e750e7a673fff7bc124005ff',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837454',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f060ad94ee75f95fc1c21b868967d14e',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837453',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '533337cd87195162490e5b90fc7266c2',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761837454',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'bc84b384ea1487b544d01019e4b84605',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837454',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'cede58df87abc40bfd84059f59a40696',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837454',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '8720f1e74cbfee79d2c499f8aefd4fa0',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761837455',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '0a3798358c7e437a927463bde42db183',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761837454',
    'x-request-id': '18b213ca3c59ccc1d86116f306f60f34',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761837455',
    'x-request-id': '2adeaefa4531ad7a8035c1f50d1b72a1',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:32 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761837455',
    'x-request-id': '7a4e6fcc549876bcf50b334ad42fe545',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:17:33 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '191',
    'x-ratelimit-reset': '1761837455',
    'x-request-id': '2c601f0f97df30ffae172804e7f93945',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Orders] Retrieved 200 orders for user 6477cf0011fcccfa0365bc87
[Scheduler] Checking for portfolios due for rebalancing...
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/8eba1252b35f97e09a8001633ae6b010
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:18:35 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837516',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f76efb8599123ed345cf09347979de0e',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:18:35 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837516',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'de9c3607cd231733c949af272b4fd92b',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:18:36 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837516',
    'x-request-id': '41255284aa26ce646cf16042e24d52e6',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:18:36 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837516',
    'x-request-id': '5737ae38e933241ef3283329ac9542f0',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[Orders] Incoming request for user 6477cf0011fcccfa0365bc87 authenticated as 6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/8eba1252b35f97e09a8001633ae6b010
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837599',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '3f72635ca8c84538055b1837756ff0f3',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837599',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '5ea0f0892c255aec18bdd0544c641515',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837599',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'd3d6dc07f1f24cb6538d9a84ef7532b9',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837600',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'c509ce70223e32bb026120e57354cedd',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837599',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '7bd4f0c52c79c757afa9d1e8a8471758',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837600',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '0e9bcb33178b4ec2a1cc675daa803b1a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837600',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'd34a341b31508036df39b6853abce545',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837600',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '110363a3e82d432c27130e35fa736eaa',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837599',
    'x-request-id': '0c9e209ecd5700c65c6577cbea40cf4d',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837599',
    'x-request-id': '3c09f4711fc97a40ecf9ed10f6cc6c53',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837600',
    'x-request-id': '1015c511645411c4cebe41172a64e32f',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837599',
    'x-request-id': '77787f6a355389f7b0c2e0fdf8890168',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837600',
    'x-request-id': '98fc74e93af159b8a4ce1371207e5150',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837600',
    'x-request-id': '344f29bad9a298fff7fe760eff643b6c',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/UVXY/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/QBTS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/IONQ/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/ARQQ/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/AMZN/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/IBM/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761837601',
    'x-request-id': 'b7bfcd307f10e262d8052530b5a8b56a',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761837601',
    'x-request-id': '1da4ed90d972e7b1099527a66f630fd1',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Orders] Retrieved 200 orders for user 6477cf0011fcccfa0365bc87
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json',
    'content-length': '126',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837600',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'ba2ce2e4f84ff7554c10f6d42c77fc67',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837600',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '986a48480cce6c08005ff99d0a655b9a',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json',
    'content-length': '115',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837600',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f618a8cb6d0db07a70417cf00105cc2f',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json',
    'content-length': '113',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837600',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '6ea602b2a3c80e14684c20d1440f2787',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837601',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '5588467677030a53024f316c857528a7',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761837601',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '88945184edafc5eaf30fcd5b0c217f1b',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761837601',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '1af5f91d03703298a01de4c7c4962a37',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:19:59 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761837602',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'caa0ae066ec269fdbf00226de3b791df',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[Scheduler] Checking for portfolios due for rebalancing...
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/8eba1252b35f97e09a8001633ae6b010
[HTTP] Incoming GET request for /api/strategies/logs/6477cf0011fcccfa0365bc87/8eba1252b35f97e09a8001633ae6b010
[HTTP] Incoming GET request for /api/strategies/all/6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/data/portfolio/6477cf0011fcccfa0365bc87
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[HTTP] Incoming GET request for /api/order/6477cf0011fcccfa0365bc87
[Orders] Incoming request for user 6477cf0011fcccfa0365bc87 authenticated as 6477cf0011fcccfa0365bc87
[HTTP] Incoming GET request for /api/strategies/portfolios/6477cf0011fcccfa0365bc87
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837604',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '3a5ab9bbf2cdfeb578fdd0b93271abf7',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '121',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837604',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'b80bdff6e7b069c858497e72fa95cee3',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing live trading mode
[API Info] Forcing live trading mode
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/account/portfolio/history?period=12M',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837604',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'e6ca8f9f81bc8fb09c4df8ff568d2931',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837604',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'bcc70ce937fa523f912093f1a426018f',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837605',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '6a8257eadb2fce1082924c9c89a0d339',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '123',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837605',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f53b7aed7ca7103d61154d2dbb2c0b7d',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/orders',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837605',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'f8d0f1838bd50eb5a0d0b0b7534a9aca',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837605',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '38ee4ff297c7aaf8960849324577a489',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Using paper trading keys for trading operations
[API Info] Using paper trading keys for trading operations
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-portfolio-history-engine-version': 'v2',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837604',
    'x-request-id': '0085aa0e562cf7142689d9f18b4e1c80',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837604',
    'x-request-id': 'ad13324a91a508eb14ef970887c95005',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837604',
    'x-request-id': 'eeadf361a18f4be3228f7687bf56d45e',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[HTTP] Incoming GET request for /api/stock/6477cf0011fcccfa0365bc87
[Stocks] getStockForUser called {
  userId: '6477cf0011fcccfa0365bc87',
  authUser: '6477cf0011fcccfa0365bc87',
  mongoState: 1
}
[Stocks] Fetching user document
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837605',
    'x-request-id': 'dd73f22f0f31baedcdbc4a0917e59bda',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837605',
    'x-request-id': 'f226274d53cd0b8681f15ea34569af6c',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Stocks] User document loaded { userId: new ObjectId("6477cf0011fcccfa0365bc87") }
[Debug] Environment variables loaded:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[Debug] - Live Key ID: AKILU...
[Debug] - Live Secret: 6v68e...
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/UVXY/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/PETS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/CAT/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/QBTS/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/IONQ/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/ARQQ/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/AMZN/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Request] {
  method: 'GET',
  url: 'https://data.alpaca.markets/v2/stocks/IBM/trades/latest',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[Debug] User document found, checking for API keys
[Debug] After user document check:
[Debug] - Paper Key ID: PK5SX...
[Debug] - Paper Secret: OeC06...
[API Info] Paper trading keys are present
[API Info] Live trading key format is valid (starts with AK)
[API Info] Validating Paper trading keys at https://paper-api.alpaca.markets/v2/clock
[API Debug] Using key ID: PK5SX...
[API Info] Validating Live trading keys at https://api.alpaca.markets/v2/clock
[API Debug] Using key ID: AKILU...
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://api.alpaca.markets/v2/clock',
  headers: { 'APCA-API-KEY-ID': 'AKILU...', 'APCA-API-SECRET-KEY': '6v68e...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837605',
    'x-request-id': 'bda8f9f12644cf81a28865f47147e57f',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '196',
    'x-ratelimit-reset': '1761837605',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'b2667c3df9671dcc68365fc4ec10f578',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '120',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837605',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'e858a145fbb6d1386c6d95ac9a66c40f',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '115',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761837606',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'b3fc70f2d8a3753b5404b73089d37083',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '126',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761837606',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'b40552c9b5b6db83cbba205170a416f3',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '197',
    'x-ratelimit-reset': '1761837605',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'c4396867ea765a6b1dc5e0ab79b55d78',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761837606',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'a9e37f8afabc254d77d0bdbe2e446592',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '113',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '199',
    'x-ratelimit-reset': '1761837604',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '33ecf264e96233e569a0c03b2fa6fbba',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837605',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '330891576daf4bb0ead8ee239c0f6479',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Live trading keys validated successfully
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '122',
    connection: 'keep-alive',
    vary: 'Accept-Encoding',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '195',
    'x-ratelimit-reset': '1761837605',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': '33b9c1ce79d66ca7df2b5f4ce03db6c8',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Success] Paper trading keys validated successfully
[API Info] Final configuration:
[API Info] - Paper trading keys valid: true
[API Info] - Live trading keys valid: true
[API Info] - Trading API URL: https://paper-api.alpaca.markets
[API Info] - Data API URL: https://data.alpaca.markets
[API Info] Forcing paper trading mode
[API Info] Forcing paper trading mode
Using paper trading API: https://paper-api.alpaca.markets
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/positions',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json',
    'content-length': '127',
    connection: 'keep-alive',
    'x-feed': 'iex',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '198',
    'x-ratelimit-reset': '1761837605',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'x-request-id': 'd87c5494a9d82b5e97d1f8e0162d6716',
    'access-control-allow-origin': '*',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '194',
    'x-ratelimit-reset': '1761837606',
    'x-request-id': '1896a8b05feedadc20b3f459a2ce07c0',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Request] {
  method: 'GET',
  url: 'https://paper-api.alpaca.markets/v2/account',
  headers: { 'APCA-API-KEY-ID': 'PK5SX...', 'APCA-API-SECRET-KEY': 'OeC06...' }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '192',
    'x-ratelimit-reset': '1761837606',
    'x-request-id': 'e0b87c6ba6eb95614f0896b2dfc55dd2',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '193',
    'x-ratelimit-reset': '1761837606',
    'x-request-id': 'd9207f58a9ba8307199d3324753f3268',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[API Response] {
  status: 200,
  statusText: 'OK',
  headers: Object [AxiosHeaders] {
    date: 'Thu, 30 Oct 2025 15:20:04 GMT',
    'content-type': 'application/json; charset=UTF-8',
    'transfer-encoding': 'chunked',
    connection: 'keep-alive',
    vary: 'Accept-Encoding, Origin',
    'access-control-allow-origin': '*',
    'x-ratelimit-limit': '200',
    'x-ratelimit-remaining': '191',
    'x-ratelimit-reset': '1761837607',
    'x-request-id': '27679025235727c4c2ac13ef816ae67a',
    'strict-transport-security': 'max-age=31536000; includeSubDomains',
    'access-control-allow-credentials': 'true',
    'access-control-allow-methods': 'GET, OPTIONS, PUT, DELETE, POST, PATCH',
    'access-control-allow-headers': 'Apca-Api-Key-Id, Apca-Api-Secret-Key, Authorization, Content-Type, X-Correspondent',
    'access-control-max-age': '1728000'
  }
}
[Orders] Retrieved 200 orders for user 6477cf0011fcccfa0365bc87
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
[Scheduler] Checking for portfolios due for rebalancing...
